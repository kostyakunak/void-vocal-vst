# üîí –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å Git

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `git add -A` Git –º–æ–∂–µ—Ç –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –∏–∑ –≤—Å–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Desktop, –≤–∫–ª—é—á–∞—è:
- Downloads (–º–æ–≥—É—Ç –±—ã—Ç—å –æ–≥—Ä–æ–º–Ω—ã–µ —Ñ–∞–π–ª—ã)
- –î—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ú–µ–¥–∏–∞-—Ñ–∞–π–ª—ã

–≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫:
- **35+ GB –º—É—Å–æ—Ä–∞ –≤ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏** (–∫–∞–∫ –±—ã–ª–æ —É –Ω–∞—Å)
- –ó–∞–º–µ–¥–ª–µ–Ω–∏—é —Ä–∞–±–æ—Ç—ã Git
- –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—é –¥–∏—Å–∫–∞
- –ü—Ä–æ–±–ª–µ–º–∞–º —Å –ø–∞–º—è—Ç—å—é

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
./git-safe-add.sh

# –ò–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–∞–ø–∫—É
./git-safe-add.sh Source/
./git-safe-add.sh Documentation/
```

### 2. –Ø–≤–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

```bash
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω–æ–µ
git add Source/ Documentation/ CMakeLists.txt
git add .gitignore build.sh install.sh

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û - –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –ø–æ–¥—Ä—è–¥
git add -A
git add .
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

```bash
# –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —á—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ
git status --short

# –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –ª–∏—à–Ω–µ–µ:
git reset              # –û—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ
git reset <file>       # –û—Ç–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
```

## üõ°Ô∏è –ó–∞—â–∏—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã

### Pre-commit Hook

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤ (–º–∞–∫—Å–∏–º—É–º 10MB –Ω–∞ —Ñ–∞–π–ª)
- –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ >50MB)

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `.git/hooks/pre-commit` (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

### –£–ª—É—á—à–µ–Ω–Ω—ã–π .gitignore

–ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç:
- –ê—Ä—Ö–∏–≤—ã (`.zip`, `.tar`, `.rar`, `.7z`)
- –ú–µ–¥–∏–∞-—Ñ–∞–π–ª—ã (`.wav`, `.mp3`, `.mov`, `.mp4`)
- –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (`.dmg`, `.pkg`, `.iso`)
- –°—ç–º–ø–ª—ã –∏ –ø—Ä–µ—Å–µ—Ç—ã (`.sf2`, `.nki`)

### –†–µ–≥—É–ª—è—Ä–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞

–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–π—Ç–µ Git –º—É—Å–æ—Ä:

```bash
# –û—á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞
git gc --prune=now

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
git count-objects -vH
```

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º

- [ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `./git-safe-add.sh` –∏–ª–∏ —è–≤–Ω–æ–µ `git add`
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª `git status --short` - –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤
- [ ] –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –±–æ–ª—å—à–µ 10MB (–µ—Å–ª–∏ –Ω—É–∂–Ω—ã - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ git-lfs)
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –ø–ª–∞–≥–∏–Ω–∞ (–µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω –∫–æ–¥)
- [ ] –°–æ–±—Ä–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –ø–ª–∞–≥–∏–Ω

## üö® –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –û—Ç–º–µ–Ω–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤:

```bash
git reset              # –û—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ staged —Ñ–∞–π–ª—ã
git reset <file>       # –û—Ç–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
```

### –û—á–∏—Å—Ç–∏—Ç—å Git –º—É—Å–æ—Ä:

```bash
# –û—á–∏—Å—Ç–∫–∞ reflog –∏ –º—É—Å–æ—Ä–∞
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
git count-objects -vH
```

### –£–¥–∞–ª–∏—Ç—å –±–æ–ª—å—à–æ–π —Ñ–∞–π–ª –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏:

```bash
# –ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –∑–∞–∫–æ–º–º–∏—á–µ–Ω
git filter-branch --tree-filter 'rm -f path/to/large/file' HEAD
git gc --prune=now
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ä–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:

```bash
# –†–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
du -sh .git

# –î–µ—Ç–∞–ª–∏ –æ–±—ä–µ–∫—Ç–æ–≤
git count-objects -vH

# –ö—Ä—É–ø–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏
git rev-list --objects --all | \
  git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' | \
  awk '/^blob/ {print substr($0,6)}' | \
  sort --numeric-sort --key=2 | \
  tail -10
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `./git-safe-add.sh`** –≤–º–µ—Å—Ç–æ `git add -A`
2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `git status`** –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ –º—É—Å–æ—Ä** (`git gc --prune=now`)
4. **–î–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Git LFS –∏–ª–∏ –¥–æ–±–∞–≤–ª—è–π—Ç–µ –≤ `.gitignore`
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** –≤ –∫–æ–º–º–∏—Ç-—Å–æ–æ–±—â–µ–Ω–∏—è—Ö

